image: docker.io/cimg/rust:1.88.0
variables:
    DOCKER_HOST: tcp://docker:2375/
    DOCKER_TLS_CERTDIR: ""
    DOCKER_DRIVER: overlay2
    CROSS_REMOTE: 1
services:
    - docker.io/docker:dind
before_script:
  - cargo install cross
    

test:
  script:
    - rustc --version && cargo --version
    - cargo xtask test 

build:amd64linux:
    script:
        - rustc --version && cargo --version
        - cargo install cross
        - cargo xtask build x86_64-unknown-linux-musl
        - cargo xtask build aarch64-unknown-linux-musl
        - cargo xtask build x86_64-unknown-freebsd
        - cargo xtask build x86_64-unknown-illumos

